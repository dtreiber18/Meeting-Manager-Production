<main class="settings-container max-w-7xl mx-auto p-6 space-y-6" 
      aria-label="Settings Page"
      aria-describedby="settings-description" 
      title="Settings Page" 
      role="main">
  <div id="settings-description" class="sr-only">Application settings and configuration page</div>
  <!-- Page Header -->
  <div class="mb-8">
    <h1 class="text-3xl font-bold text-gray-900">Settings</h1>
    <p class="text-gray-600 mt-2">Manage your account and application integrations</p>
  </div>

  <!-- Main Settings Card -->
  <mat-card class="settings-card">
    <!-- Tabs Navigation -->
    <mat-tab-group [(selectedIndex)]="activeTabIndex" (selectedTabChange)="onTabChange($event.index || 0)"
      class="settings-tabs" title="Settings Tabs" [attr.aria-label]="'Settings navigation tabs'">

      <!-- Account Tab -->
      <mat-tab label="Account Info" [attr.aria-label]="'Account information settings'">
        <ng-template matTabContent>
          <div class="tab-content p-6">
            <!-- Account Information -->
            <div class="professional-form-container">
              <div class="form-section">
                <h3 class="section-title" id="account-info-title">Account Information</h3>
                <p class="section-description">Update your personal details and contact information</p>

                <form [formGroup]="accountForm" (ngSubmit)="onAccountUpdate()" class="professional-form-field"
                  [attr.aria-labelledby]="'account-info-title'">
                  <div class="professional-form-grid grid-cols-2">
                    <mat-form-field appearance="outline" class="w-full">
                      <mat-label>Display Name</mat-label>
                      <input matInput formControlName="name" placeholder="Enter your name" title="Display Name"
                        [attr.aria-describedby]="'name-errors'">
                      <div id="name-errors">
                        <mat-error *ngIf="hasFieldError(accountForm, 'name', 'required')">
                          Name is required
                        </mat-error>
                        <mat-error *ngIf="hasFieldError(accountForm, 'name', 'minlength')">
                          Name must be at least 2 characters
                        </mat-error>
                        <mat-error *ngIf="hasFieldError(accountForm, 'name', 'maxlength')">
                          Name cannot exceed 50 characters
                        </mat-error>
                      </div>
                    </mat-form-field>

                    <mat-form-field appearance="outline" class="w-full">
                      <mat-label>Email Address</mat-label>
                      <input matInput type="email" formControlName="email" placeholder="Enter your email" title="Email Address"
                        [attr.aria-describedby]="'email-errors'">
                      <div id="email-errors">
                        <mat-error *ngIf="hasFieldError(accountForm, 'email', 'required')">
                          Email is required
                        </mat-error>
                        <mat-error *ngIf="hasFieldError(accountForm, 'email', 'email')">
                          Please enter a valid email address
                        </mat-error>
                      </div>
                    </mat-form-field>
                  </div>

                  <div class="form-actions">
                    <button mat-raised-button type="submit" color="primary" [disabled]="!accountForm.valid || isSaving"
                      class="professional-form-button"
                      [attr.aria-label]="isSaving ? 'Saving account changes' : 'Save account changes'">
                      <mat-icon *ngIf="isSaving" class="animate-spin" [attr.aria-hidden]="true">refresh</mat-icon>
                      <mat-icon *ngIf="!isSaving" [attr.aria-hidden]="true">save</mat-icon>
                      {{ isSaving ? 'Saving...' : 'Save Changes' }}
                    </button>
                  </div>
                </form>
              </div>

              <!-- Password Change Section -->
              <div class="form-section">
                <h3 class="section-title" id="password-change-title">Change Password</h3>
                <p class="section-description">Update your account password for enhanced security</p>

                <form [formGroup]="passwordForm" (ngSubmit)="onPasswordChange()" class="professional-form-field"
                  [attr.aria-labelledby]="'password-change-title'">
                  <div class="professional-form-grid grid-cols-2">
                    <mat-form-field appearance="outline" class="w-full">
                      <mat-label>New Password</mat-label>
                      <input matInput [type]="showPassword ? 'text' : 'password'" formControlName="newPassword"
                        placeholder="Enter new password" title="New Password" [attr.aria-describedby]="'password-errors password-strength'">
                      <button mat-icon-button matSuffix (click)="togglePasswordVisibility()" type="button"
                        [attr.aria-label]="showPassword ? 'Hide password' : 'Show password'">
                        <mat-icon [attr.aria-hidden]="true">{{ showPassword ? 'visibility_off' : 'visibility'
                          }}</mat-icon>
                      </button>

                      <!-- Password Strength Indicator -->
                      <mat-hint id="password-strength" *ngIf="passwordForm.get('newPassword')?.value">
                        <div class="password-strength-container">
                          <div class="password-strength-bar">
                            <div class="password-strength-fill"
                              [style.width.%]="getPasswordStrength(passwordForm.get('newPassword')?.value).percentage"
                              [class]="'strength-' + getPasswordStrength(passwordForm.get('newPassword')?.value).level">
                            </div>
                          </div>
                          <span class="password-strength-text">
                            {{ getPasswordStrength(passwordForm.get('newPassword')?.value).label }}
                          </span>
                        </div>
                      </mat-hint>

                      <div id="password-errors">
                        <mat-error *ngIf="hasFieldError(passwordForm, 'newPassword', 'required')">
                          Password is required
                        </mat-error>
                        <mat-error *ngIf="hasFieldError(passwordForm, 'newPassword', 'minlength')">
                          Password must be at least 8 characters
                        </mat-error>
                        <mat-error *ngIf="hasFieldError(passwordForm, 'newPassword', 'pattern')">
                          Password must contain uppercase, lowercase, number, and special character
                        </mat-error>
                      </div>
                    </mat-form-field>

                    <mat-form-field appearance="outline" class="w-full">
                      <mat-label>Confirm Password</mat-label>
                      <input matInput type="password" formControlName="confirmPassword" placeholder="Confirm password" title="Confirm Password"
                        [attr.aria-describedby]="'confirm-password-errors'">
                      <div id="confirm-password-errors">
                        <mat-error *ngIf="hasFieldError(passwordForm, 'confirmPassword', 'required')">
                          Please confirm your password
                        </mat-error>
                        <mat-error
                          *ngIf="passwordForm.hasError('passwordMismatch') && passwordForm.get('confirmPassword')?.touched">
                          Passwords do not match
                        </mat-error>
                      </div>
                    </mat-form-field>
                  </div>

                  <div class="form-actions">
                    <button mat-raised-button type="submit" color="primary" [disabled]="!passwordForm.valid || isSaving"
                      class="professional-form-button"
                      [attr.aria-label]="isSaving ? 'Updating password' : 'Change password'">
                      <mat-icon *ngIf="isSaving" class="animate-spin" [attr.aria-hidden]="true">refresh</mat-icon>
                      <mat-icon *ngIf="!isSaving" [attr.aria-hidden]="true">lock</mat-icon>
                      {{ isSaving ? 'Updating...' : 'Change Password' }}
                    </button>
                  </div>
                </form>
              </div>
            </div>
          </div>
        </ng-template>
      </mat-tab>

      <!-- Sources Tab -->
      <mat-tab label="Get Info From" [attr.aria-label]="'Meeting note sources configuration'">
        <ng-template matTabContent>
          <div class="tab-content p-6">
            <!-- Navigation Header for Detail Views -->
            <div *ngIf="currentView === 'detail' && selectedApp" class="flex items-center mb-6">
              <button mat-button type="button" (click)="onBackToSummary()" class="back-button"
                [attr.aria-label]="'Back to ' + (selectedApp.type === 'source' ? 'Sources' : 'Destinations')">
                <mat-icon [attr.aria-hidden]="true">arrow_back</mat-icon>
                Back to {{ selectedApp.type === 'source' ? 'Sources' : 'Destinations' }}
              </button>
              <div class="ml-4 flex items-center">
                <div class="app-icon" [class]="'app-icon-' + selectedApp.type" [attr.aria-hidden]="true">
                  <mat-icon>{{ getAppIcon(selectedApp.name || '') }}</mat-icon>
                </div>
                <h3 class="text-lg font-semibold text-gray-900 ml-3">{{ selectedApp.name || 'Unnamed App' }}</h3>
              </div>
            </div>

            <!-- Summary View -->
            <div *ngIf="currentView === 'summary'" class="space-y-6">
              <div class="flex items-center justify-between">
                <div>
                  <h3 class="text-lg font-semibold text-gray-900" id="sources-title">Meeting Note Sources</h3>
                  <p class="text-sm text-gray-600 mt-1">Configure apps that provide meeting data</p>
                </div>
                <button mat-raised-button color="primary" (click)="addSourceApp()" class="add-button"
                  [attr.aria-label]="'Add new source application'">
                  <mat-icon [attr.aria-hidden]="true">add</mat-icon>
                  Add Source
                </button>
              </div>

              <!-- Loading State with Skeleton -->
              <output *ngIf="isLoading" class="space-y-4" aria-live="polite"
                [attr.aria-label]="'Loading source applications'"
                for="sources-loading">
                <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
                  <div *ngFor="let item of [1,2,3]" class="skeleton-card">
                    <div class="animate-pulse">
                      <div class="flex items-center space-x-4 mb-4">
                        <div class="rounded-full bg-gray-300 h-10 w-10"></div>
                        <div class="space-y-2">
                          <div class="h-4 bg-gray-300 rounded w-24"></div>
                          <div class="h-3 bg-gray-300 rounded w-32"></div>
                        </div>
                      </div>
                      <div class="h-6 bg-gray-300 rounded w-16"></div>
                    </div>
                  </div>
                </div>
              </output>

              <!-- Error State -->
              <div *ngIf="loadError && !isLoading" class="text-center py-12" role="alert">
                <mat-icon class="text-red-300 text-6xl mb-4" [attr.aria-hidden]="true">error_outline</mat-icon>
                <h3 class="text-lg font-medium text-gray-900 mb-2">Failed to load applications</h3>
                <p class="text-gray-600 mb-6">{{ loadError }}</p>
                <button mat-raised-button color="primary" (click)="loadSourceApps()">
                  <mat-icon [attr.aria-hidden]="true">refresh</mat-icon>
                  Try Again
                </button>
              </div>

              <!-- Source Apps Grid -->
              <ul *ngIf="!isLoading && !loadError" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6"
                [attr.aria-labelledby]="'sources-title'">
                <li *ngFor="let app of sourceApps; trackBy: trackByAppId">
                <mat-card 
                  class="app-card source-card cursor-pointer hover:shadow-lg transition-all duration-200"
                  [attr.tabindex]="0"
                  [attr.aria-label]="'Configure ' + (app.name || 'unnamed source') + ' application. Status: ' + (app.isActive ? 'Active' : 'Inactive')"
                  (click)="onAppClick(app)" (keydown.enter)="onAppClick(app)"
                  (keydown.space)="$event.preventDefault(); onAppClick(app)">
                  <mat-card-content>
                    <div class="flex items-center justify-between mb-4">
                      <div class="flex items-center">
                        <div class="app-icon app-icon-source" [attr.aria-hidden]="true">
                          <mat-icon>{{ getAppIcon(app.name) }}</mat-icon>
                        </div>
                        <div class="ml-3">
                          <h4 class="text-lg font-medium text-gray-900">{{ app.name || 'Unnamed Source' }}</h4>
                          <p class="text-sm text-gray-500">{{ app.apiUrl || 'No API URL configured' }}</p>
                        </div>
                      </div>
                    </div>

                    <div class="flex items-center justify-between">
                      <span class="inline-flex px-2 py-1 rounded-full text-xs font-medium"
                        [class]="app.isActive ? 'bg-green-100 text-green-800' : 'bg-gray-100 text-gray-800'"
                        [attr.aria-label]="'Status: ' + (app.isActive ? 'Active' : 'Inactive')">
                        {{ app.isActive ? 'Active' : 'Inactive' }}
                      </span>
                      <mat-icon class="text-gray-400" [attr.aria-hidden]="true">arrow_forward</mat-icon>
                    </div>
                  </mat-card-content>
                </mat-card>
                </li>
              </ul>

              <!-- Empty State -->
              <div *ngIf="!isLoading && !loadError && sourceApps.length === 0" class="text-center py-12">
                <mat-icon class="text-gray-300 text-6xl mb-4" [attr.aria-hidden]="true">storage</mat-icon>
                <h3 class="text-lg font-medium text-gray-900 mb-2">No source applications configured</h3>
                <p class="text-gray-600 mb-6">Add your first source to start importing meeting data</p>
                <button mat-raised-button color="primary" (click)="addSourceApp()">
                  <mat-icon [attr.aria-hidden]="true">add</mat-icon>
                  Add Source
                </button>
              </div>
            </div>

            <!-- Detail View for Sources -->
            <div *ngIf="currentView === 'detail' && selectedApp && selectedApp.type === 'source'" class="space-y-6">
              <!-- App Configuration Header -->
              <div class="flex items-center justify-between">
                <div>
                  <h3 class="text-lg font-semibold text-gray-900" id="source-config-title">Source Configuration</h3>
                  <p class="text-sm text-gray-600 mt-1">Configure API settings and field mappings</p>
                </div>
                  <div class="flex items-center space-x-4">
                    <mat-checkbox [(ngModel)]="selectedApp!.isActive"
                      (change)="updateApp({ isActive: selectedApp!.isActive })" color="primary"
                      [id]="'app-active-checkbox'"
                      [attr.aria-label]="'Toggle application active status'" 
                      name="appActiveStatus">
                      Active
                    </mat-checkbox>
                    <button mat-button color="warn" type="button" (click)="confirmDeleteApp()"
                      [attr.aria-label]="'Delete application'">
                      <mat-icon [attr.aria-hidden]="true">delete</mat-icon>
                      Delete
                    </button>
                  </div>
                </div>
              </div>

                <!-- Basic Configuration Card -->
                <div class="professional-form-container">
                  <div class="form-section">
                    <h3 class="section-title">Basic Configuration</h3>
                    <p class="section-description">Configure basic settings for {{ selectedApp?.name || 'this application' }}</p>

                    <form [formGroup]="appConfigForm" class="professional-form-field">
                      <mat-form-field appearance="outline" class="w-full">
                        <mat-label>App Name</mat-label>
                        <input matInput formControlName="name" placeholder="Enter app name" title="App Name"
                          [attr.aria-describedby]="'app-name-hint'">
                        <mat-hint id="app-name-hint">Choose a descriptive name for this source</mat-hint>
                      </mat-form-field>

                      <mat-form-field appearance="outline" class="w-full">
                        <mat-label>Connection Type</mat-label>
                        <mat-select formControlName="connectionType" title="Connection Type" [attr.aria-describedby]="'connection-type-hint'">
                          <mat-option value="api">API Connection</mat-option>
                          <mat-option value="folder">Folder Access</mat-option>
                        </mat-select>
                        <mat-hint id="connection-type-hint">How this application will connect to your data</mat-hint>
                      </mat-form-field>

                      <!-- API Configuration -->
                      <div *ngIf="appConfigForm.get('connectionType')?.value === 'api'"
                        class="professional-form-grid grid-cols-2">
                        <mat-form-field appearance="outline">
                          <mat-label>API URL</mat-label>
                          <input matInput type="url" formControlName="apiUrl" placeholder="https://api.example.com/v1" title="API URL"
                            [attr.aria-describedby]="'api-url-hint'">
                          <mat-hint id="api-url-hint">The base URL for API requests</mat-hint>
                          <mat-error *ngIf="hasFieldError(appConfigForm, 'apiUrl', 'pattern')">
                            Please enter a valid URL
                          </mat-error>
                        </mat-form-field>

                        <mat-form-field appearance="outline">
                          <mat-label>API Key</mat-label>
                          <input matInput [type]="showApiKey ? 'text' : 'password'" formControlName="apiKey"
                            placeholder="Enter API key" title="API Key" [attr.aria-describedby]="'api-key-hint'">
                          <button mat-icon-button matSuffix (click)="toggleApiKeyVisibility()" type="button"
                            [attr.aria-label]="showApiKey ? 'Hide API key' : 'Show API key'">
                            <mat-icon [attr.aria-hidden]="true">{{ showApiKey ? 'visibility_off' : 'visibility'
                              }}</mat-icon>
                          </button>
                          <mat-hint id="api-key-hint">Authentication key for API access</mat-hint>
                        </mat-form-field>
                      </div>

                      <!-- Folder Configuration -->
                      <div *ngIf="appConfigForm.get('connectionType')?.value === 'folder'" class="space-y-4">
                        <mat-form-field appearance="outline" class="w-full">
                          <mat-label>Folder Path</mat-label>
                          <input matInput formControlName="folderPath"
                            placeholder="/path/to/meeting/notes or \\server\\share\\meetings" title="Folder Path"
                            [attr.aria-describedby]="'folder-path-hint'">
                          <mat-hint id="folder-path-hint">Local or network path to meeting files</mat-hint>
                        </mat-form-field>

                        <div class="professional-form-grid grid-cols-2">
                          <mat-form-field appearance="outline">
                            <mat-label>Username (Optional)</mat-label>
                            <input matInput formControlName="username" placeholder="Username for folder access" title="Username"
                              [attr.aria-describedby]="'username-hint'">
                            <mat-hint id="username-hint">Username for network folder access</mat-hint>
                          </mat-form-field>

                          <mat-form-field appearance="outline">
                            <mat-label>Password (Optional)</mat-label>
                            <input matInput type="password" formControlName="password"
                              placeholder="Password for folder access" title="Folder Access Password" [attr.aria-describedby]="'folder-password-hint'">
                            <mat-hint id="folder-password-hint">Password for network folder access</mat-hint>
                          </mat-form-field>
                        </div>
                      </div>

                      <!-- Action Buttons -->
                      <div class="form-actions">
                        <button mat-outlined-button type="button" color="accent" (click)="testConnection()"
                          [disabled]="isTestingConnection || !canTestConnection()" class="professional-form-button"
                          [attr.aria-label]="isTestingConnection ? 'Testing connection' : 'Test connection'">
                          <mat-icon *ngIf="isTestingConnection" class="animate-spin"
                            [attr.aria-hidden]="true">refresh</mat-icon>
                          <mat-icon *ngIf="!isTestingConnection" [attr.aria-hidden]="true">wifi</mat-icon>
                          {{ isTestingConnection ? 'Testing...' : 'Test Connection' }}
                        </button>

                        <button mat-raised-button type="button" color="primary" (click)="saveAppConfig()"
                          [disabled]="!appConfigForm.valid || isSaving" class="professional-form-button"
                          [attr.aria-label]="isSaving ? 'Saving configuration' : 'Save configuration'">
                          <mat-icon *ngIf="isSaving" class="animate-spin" [attr.aria-hidden]="true">refresh</mat-icon>
                          <mat-icon *ngIf="!isSaving" [attr.aria-hidden]="true">save</mat-icon>
                          {{ isSaving ? 'Saving...' : 'Save Configuration' }}
                        </button>
                      </div>
                    </form>
                  </div>
                </div>

                <!-- Field Mapping Card -->
                <mat-card class="field-mapping-card">
                  <mat-card-header>
                    <mat-card-title id="field-mapping-title">Field Mapping</mat-card-title>
                    <mat-card-subtitle>Map fields from {{ selectedApp?.name || 'this application' }} to our platform</mat-card-subtitle>
                  </mat-card-header>
                  <mat-card-content>
                    <fieldset class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4"
                      [attr.aria-labelledby]="'field-mapping-title'">
                      <legend class="sr-only">Field Mapping Configuration</legend>
                      <mat-form-field *ngFor="let field of fieldMappingConfig; trackBy: trackByFieldKey"
                        appearance="outline">
                        <mat-label>{{ field.label }}</mat-label>
                        <input matInput [id]="'field-' + field.key" [value]="getFieldMappingValue(field.key)"
                          (input)="updateFieldMapping(field.key, $any($event.target).value)"
                          [placeholder]="field.placeholder" [title]="field.label" [attr.aria-describedby]="'field-' + field.key + '-hint'"
                          [attr.aria-label]="field.label + ' field mapping'">
                        <mat-hint [id]="'field-' + field.key + '-hint'">
                          {{ field.hint || 'Map this field to your data source' }}
                        </mat-hint>
                      </mat-form-field>
                    </fieldset>
                  </mat-card-content>
                </mat-card>
            </div>
        </ng-template>
      </mat-tab>

      <!-- Destinations Tab -->
      <mat-tab label="Send Info To" [attr.aria-label]="'Action destinations configuration'">
        <ng-template matTabContent>
          <div class="tab-content p-6">
            <!-- Summary View -->
            <div *ngIf="currentView === 'summary'" class="space-y-6">
              <div class="flex items-center justify-between">
                <div>
                  <h3 class="text-lg font-semibold text-gray-900" id="destinations-title">Action Destinations</h3>
                  <p class="text-sm text-gray-600 mt-1">Configure apps where actions will be created</p>
                </div>
                <button mat-raised-button color="primary" (click)="addDestinationApp()" class="add-button"
                  [attr.aria-label]="'Add new destination application'">
                  <mat-icon [attr.aria-hidden]="true">add</mat-icon>
                  Add Destination
                </button>
              </div>

              <!-- Loading State -->
              <output *ngIf="isLoading" class="space-y-4" aria-live="polite"
                [attr.aria-label]="'Loading destination applications'"
                for="destinations-loading">
                <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
                  <div *ngFor="let item of [1,2,3]" class="skeleton-card">
                    <div class="animate-pulse">
                      <div class="flex items-center space-x-4 mb-4">
                        <div class="rounded-full bg-gray-300 h-10 w-10"></div>
                        <div class="space-y-2">
                          <div class="h-4 bg-gray-300 rounded w-24"></div>
                          <div class="h-3 bg-gray-300 rounded w-32"></div>
                        </div>
                      </div>
                      <div class="h-6 bg-gray-300 rounded w-16"></div>
                    </div>
                  </div>
                </div>
              </output>

              <!-- Destination Apps Grid -->
              <ul *ngIf="!isLoading" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6"
                [attr.aria-labelledby]="'destinations-title'">
                <li *ngFor="let app of destinationApps; trackBy: trackByAppId">
                <mat-card 
                  class="app-card destination-card cursor-pointer hover:shadow-lg transition-all duration-200"
                  [attr.tabindex]="0"
                  [attr.aria-label]="'Configure ' + (app.name || 'unnamed destination') + ' application. Status: ' + (app.isActive ? 'Active' : 'Inactive')"
                  (click)="onAppClick(app)" (keydown.enter)="onAppClick(app)"
                  (keydown.space)="$event.preventDefault(); onAppClick(app)">
                  <mat-card-content>
                    <div class="flex items-center justify-between mb-4">
                      <div class="flex items-center">
                        <div class="app-icon app-icon-destination" [attr.aria-hidden]="true">
                          <mat-icon>{{ getAppIcon(app.name) }}</mat-icon>
                        </div>
                        <div class="ml-3">
                          <h4 class="text-lg font-medium text-gray-900">{{ app.name || 'Unnamed Destination' }}</h4>
                          <p class="text-sm text-gray-500">{{ app.apiUrl || 'No API URL configured' }}</p>
                        </div>
                      </div>
                    </div>

                    <div class="flex items-center justify-between">
                      <span class="inline-flex px-2 py-1 rounded-full text-xs font-medium"
                        [class]="app.isActive ? 'bg-green-100 text-green-800' : 'bg-gray-100 text-gray-800'"
                        [attr.aria-label]="'Status: ' + (app.isActive ? 'Active' : 'Inactive')">
                        {{ app.isActive ? 'Active' : 'Inactive' }}
                      </span>
                      <mat-icon class="text-gray-400" [attr.aria-hidden]="true">arrow_forward</mat-icon>
                    </div>
                  </mat-card-content>
                </mat-card>
                </li>
              </ul>

              <!-- Empty State -->
              <div *ngIf="!isLoading && destinationApps.length === 0" class="text-center py-12">
                <mat-icon class="text-gray-300 text-6xl mb-4" [attr.aria-hidden]="true">send</mat-icon>
                <h3 class="text-lg font-medium text-gray-900 mb-2">No destination applications configured</h3>
                <p class="text-gray-600 mb-6">Add your first destination to start sending meeting data</p>
                <button mat-raised-button color="primary" (click)="addDestinationApp()">
                  <mat-icon [attr.aria-hidden]="true">add</mat-icon>
                  Add Destination
                </button>
              </div>
            </div>

            <!-- Detail View for Destinations -->
            <div *ngIf="currentView === 'detail' && selectedApp && selectedApp.type === 'destination'"
              class="space-y-6">
              <!-- Similar configuration content as sources but with destination-specific styling -->
              <!-- Content would be nearly identical to source configuration -->
              <div class="text-center py-12">
                <p class="text-gray-600">Destination configuration panel - similar to source configuration</p>
              </div>
            </div>
          </div>
        </ng-template>
      </mat-tab>

      <!-- Calendar Integration Tab -->
      <mat-tab label="Calendar Integration" [attr.aria-label]="'Calendar integration settings'">
        <ng-template matTabContent>
          <div class="tab-content p-6">
            <div class="professional-form-container">
              <div class="form-section">
                <h3 class="section-title" id="calendar-integration-title">Microsoft Outlook Calendar</h3>
                <p class="section-description">Connect your Outlook calendar to automatically sync meetings and events</p>

                <!-- Loading State -->
                <output *ngIf="isLoadingCalendar" class="flex items-center justify-center py-12" aria-live="polite"
                  for="calendar-loading">
                  <mat-icon class="animate-spin text-4xl text-blue-500 mr-4" [attr.aria-hidden]="true">refresh</mat-icon>
                  <span class="text-lg text-gray-600">Checking calendar status...</span>
                </output>

                <!-- Calendar Status Display -->
                <div *ngIf="!isLoadingCalendar && calendarStatus" class="space-y-6">
                  <!-- Connected Status -->
                  <div *ngIf="calendarStatus.isConnected" class="bg-green-50 border border-green-200 rounded-lg p-6">
                    <div class="flex items-center">
                      <div class="flex-shrink-0">
                        <mat-icon class="text-green-600 text-4xl" [attr.aria-hidden]="true">check_circle</mat-icon>
                      </div>
                      <div class="ml-4 flex-1">
                        <h4 class="text-lg font-semibold text-green-900">Calendar Connected</h4>
                        <p class="text-green-700 mt-1">
                          Your Outlook calendar is successfully connected. 
                          <span *ngIf="calendarStatus.userEmail" class="font-medium">{{ calendarStatus.userEmail }}</span>
                        </p>
                        <p class="text-green-600 text-sm mt-2">
                          Meetings will automatically sync with your calendar.
                        </p>
                      </div>
                    </div>

                    <div class="mt-6 flex items-center space-x-4">
                      <button mat-raised-button color="accent" (click)="refreshCalendarStatus()" class="professional-form-button">
                        <mat-icon [attr.aria-hidden]="true">refresh</mat-icon>
                        Refresh Status
                      </button>
                      <button mat-raised-button color="warn" (click)="disconnectCalendar()" class="professional-form-button">
                        <mat-icon [attr.aria-hidden]="true">link_off</mat-icon>
                        Disconnect Calendar
                      </button>
                    </div>
                  </div>

                  <!-- Disconnected Status -->
                  <div *ngIf="!calendarStatus.isConnected" class="bg-orange-50 border border-orange-200 rounded-lg p-6">
                    <div class="flex items-center">
                      <div class="flex-shrink-0">
                        <mat-icon class="text-orange-600 text-4xl" [attr.aria-hidden]="true">warning</mat-icon>
                      </div>
                      <div class="ml-4 flex-1">
                        <h4 class="text-lg font-semibold text-orange-900">Calendar Not Connected</h4>
                        <p class="text-orange-700 mt-1" *ngIf="calendarStatus.userEmail">
                          Connect your Outlook calendar to automatically schedule and sync meetings.
                        </p>
                        <p class="text-orange-700 mt-1" *ngIf="!calendarStatus.userEmail">
                          Please ensure you are logged in to connect your Outlook calendar.
                        </p>
                        <p class="text-orange-600 text-sm mt-2">
                          Calendar integration allows automatic meeting creation and synchronization.
                        </p>
                      </div>
                    </div>

                    <div class="mt-6 flex items-center space-x-4">
                      <button mat-raised-button color="primary" (click)="connectCalendar()" 
                              [disabled]="!calendarStatus.userEmail" class="professional-form-button">
                        <mat-icon [attr.aria-hidden]="true">link</mat-icon>
                        Connect Outlook Calendar
                      </button>
                      <button mat-raised-button color="accent" (click)="refreshCalendarStatus()" class="professional-form-button">
                        <mat-icon [attr.aria-hidden]="true">refresh</mat-icon>
                        Refresh Status
                      </button>
                    </div>
                  </div>

                  <!-- Calendar Features Info -->
                  <mat-card class="bg-blue-50 border-blue-200">
                    <mat-card-header>
                      <mat-card-title class="text-blue-900">
                        <mat-icon class="text-blue-600 mr-2" [attr.aria-hidden]="true">info</mat-icon>
                        Calendar Integration Features
                      </mat-card-title>
                    </mat-card-header>
                    <mat-card-content class="text-blue-800">
                      <ul class="space-y-2">
                        <li class="flex items-center">
                          <mat-icon class="text-blue-600 mr-2 text-sm" [attr.aria-hidden]="true">check</mat-icon>
                          Automatic meeting creation in Outlook
                        </li>
                        <li class="flex items-center">
                          <mat-icon class="text-blue-600 mr-2 text-sm" [attr.aria-hidden]="true">check</mat-icon>
                          Sync meeting attendees and details
                        </li>
                        <li class="flex items-center">
                          <mat-icon class="text-blue-600 mr-2 text-sm" [attr.aria-hidden]="true">check</mat-icon>
                          Real-time calendar updates
                        </li>
                        <li class="flex items-center">
                          <mat-icon class="text-blue-600 mr-2 text-sm" [attr.aria-hidden]="true">check</mat-icon>
                          Meeting reminders and notifications
                        </li>
                      </ul>
                    </mat-card-content>
                  </mat-card>
                </div>

                <!-- Error State -->
                <div *ngIf="!isLoadingCalendar && !calendarStatus" class="text-center py-12" role="alert">
                  <mat-icon class="text-red-300 text-6xl mb-4" [attr.aria-hidden]="true">error_outline</mat-icon>
                  <h3 class="text-lg font-medium text-gray-900 mb-2">Unable to load calendar status</h3>
                  <p class="text-gray-600 mb-6">There was an error loading your calendar integration status.</p>
                  <button mat-raised-button color="primary" (click)="refreshCalendarStatus()">
                    <mat-icon [attr.aria-hidden]="true">refresh</mat-icon>
                    Try Again
                  </button>
                </div>
              </div>
            </div>
          </div>
        </ng-template>
      </mat-tab>
    </mat-tab-group>
  </mat-card>
</main>